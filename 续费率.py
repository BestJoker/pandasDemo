import pandas as pdimport numpy as npimport osimport matplotlib.pyplot as pltimport scipy.stats as stimport mathplt.rcParams['font.sans-serif']=['Microsoft YaHei'] #用来正常显示中文标签字体。Microsoft YaHei 或 SimHeiplt.rcParams['axes.unicode_minus']=False #用来正常显示负号PROJECT_ROOT = os.path.dirname(os.path.realpath(__file__))path = os.path.join(PROJECT_ROOT,'data/数据汇总.xlsx')df = pd.read_excel(path,sheet_name='2019-05')print (df)print (df.info())print ('-'*30)#续费的人数据is_renew_df = df[df['is_renew_m00'] == 1].reset_index()is_renew_df = is_renew_df.dropna(axis=0,how='all')series = is_renew_df['dau_count'].value_counts()print (series.index)plt.figure(figsize=(10,5),dpi=80)plt.bar(is_renew_df['dau_count'].value_counts().index,is_renew_df['dau_count'].value_counts().values)plt.show()array = is_renew_df['dau_count'].sort_values(ascending=True).tolist()# print (np.percentile(array,2.5))# print (np.percentile(array,97.5))## print (st.norm.interval(0.95,loc=np.mean(array),scale=st.sem(array)))#print (is_renew_df['dau_count'].mean())##自定义的median_ci函数是给出某一数据95%置信区间的上限和下限对应的值def median_ci(data,confidence=0.95):    data1 = sorted(data)    n = len(data1)    ll = 0.5*n - 0.98*math.sqrt(n)    ul = 1 + 0.5*n + 0.98*math.sqrt(n)    l = data1[math.ceil(ll)-1]    u = data1[math.floor(ul) - 1]    return (l,u)l,u = median_ci(array)print (l,u)