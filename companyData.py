# coding:utf-8import pandas as pdimport numpy as npimport osimport openpyxlfrom datetime import datetime,date,timedeltadef initData():    last_day = (date.today() + timedelta(days=-1)).strftime("%Y-%m-%d")  # 昨天日期    PROJECT_ROOT = os.path.dirname(os.path.realpath(__file__))    path = os.path.join(PROJECT_ROOT, 'data/企业报名转化_' + last_day + '.xlsx')    df = pd.read_excel(path)    # 去掉第一行的数字columns    df = df.rename(columns=df.loc[0])    # 删除多余的第一行数据    df.drop(labels=0, axis=0, inplace=True)    # 重新排序设置index    df = df.reset_index(drop=True)    print (df.head(10))    print (df.info())    df['领取用户数'] = df['领取用户数'].astype(int)    df['观看课程用户数'] = df['观看课程用户数'].astype(int)    df['观看转化率'] = df['观看转化率'].astype(float)    df['平均学习时长（秒）'] = df['平均学习时长（秒）'].astype(float)    return dfdef get_course_count(df):    grouped = df[['已申请的公司', '申请人', '领取用户数', '观看课程用户数']].sort_values(by='领取用户数', ascending=False).reset_index(drop=True)    print (grouped['观看课程用户数'])    print (grouped['观看课程用户数'].sum())    #截止3月21日 领取人数排名第1企业占比总数22.6%    #截止3月21日 领取人数排名前10家企业，占总领取人数45.7%    print (grouped['观看课程用户数'][0:1].sum() / grouped['观看课程用户数'].sum())    print (grouped[grouped['观看课程用户数']>0].count())df = initData()get_course_count(df)# grouped= df.groupby(by='归属分社')[['领取用户数','观看课程用户数','观看转化率','平均学习时长（秒）']].agg({#     '领取用户数':np.sum,#     '观看课程用户数':np.sum,#     '观看转化率':np.mean,#     '平均学习时长（秒）':np.mean# }).sort_values(by='领取用户数',ascending=False)# print (grouped)# print (grouped[['领取用户数','观看课程用户数']].sum())