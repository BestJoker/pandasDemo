# coding:utf-8import pandas as pdimport numpy as npimport osimport matplotlib.pyplot as pltimport scipy.stats as stimport mathimport seaborn as snsfrom time import timeimport datetimefrom sklearn.preprocessing import OneHotEncoderimport model_test_indexfrom sklearn.preprocessing import StandardScalerfrom sklearn.model_selection import GridSearchCVfrom sklearn.model_selection import train_test_splitfrom sklearn.metrics import accuracy_scorefrom sklearn.model_selection import cross_val_scorefrom sklearn.neighbors import KNeighborsClassifierfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysisfrom sklearn.naive_bayes import GaussianNBfrom sklearn.svm import SVCfrom sklearn.linear_model import LogisticRegressionfrom sklearn.tree import DecisionTreeClassifierfrom sklearn.model_selection import KFoldfrom sklearn.ensemble import RandomForestClassifierpd.options.mode.chained_assignment = None # 默认是'warn'plt.rcParams['font.sans-serif']=['Microsoft YaHei'] #用来正常显示中文标签字体。Microsoft YaHei 或 SimHeiplt.rcParams['axes.unicode_minus']=False #用来正常显示负号#初步探索选择模型def data_handel(orign_df):    columns = [        '注册至今时间(天)',        '是否新注册用户',        '是否入群',        '是否激活',        '开营前7天活跃天数',        '营期间活跃天数',        '先导课听课时长(分钟)',        '看直播课程数',        #     '看直播总时长(分钟)',        #     '看直播回放总时长(分钟)',        '看直播总互动数',        '非转化营直播课看课总时长(分钟)',        '全部课程分享次数',        '课表访问次数',        '支付页面浏览次数',        '是否购买大学籍'    ]    temp_df = orign_df[columns]    # 1.将分布不均匀数据进行取对数    # log_columns = [    #     '注册至今时间(天)',    #     '先导课听课时长(分钟)',    #     '先导课听课时长(分钟)',    #     '非转化营直播课看课总时长(分钟)',    #     '看直播总时长(分钟)'    # ]    # for column in log_columns:    #     orign_df[column] = orign_df[column].apply(np.log)    #     print column    # 2.将分类调整为0和1    temp_df['是否新注册用户'] = temp_df['是否新注册用户'].apply(lambda x: 1 if x == '是' else 0)    temp_df['是否入群'] = temp_df['是否入群'].apply(lambda x: 1 if x == '是' else 0)    temp_df['是否激活'] = temp_df['是否激活'].apply(lambda x: 1 if x == '是' else 0)    temp_df['注册至今时间(天)'] = temp_df['注册至今时间(天)'].fillna(value=0)    scaler = StandardScaler()  # 实例化    X = temp_df.iloc[:, temp_df.columns != '是否购买大学籍']    y = temp_df.iloc[:, temp_df.columns == '是否购买大学籍']    trans_x = scaler.fit_transform(X)    return X,trans_x#主函数if __name__ == '__main__':    PROJECT_ROOT = os.path.dirname(os.path.realpath(__file__))    path = os.path.join(PROJECT_ROOT,'data/进化营用户探索.xlsx')    orign_df = pd.read_excel(path)    str_columns = orign_df.select_dtypes(include=['object', 'datetime']).columns    num_columns = orign_df.select_dtypes(include=['number']).columns    orign_df[str_columns] = orign_df[str_columns].fillna('')    orign_df[num_columns] = orign_df[num_columns].fillna(value=0)    orign_df.info()    X,y = data_handel(orign_df)