# coding:utf-8import pandas as pdimport numpy as npimport osimport openpyxlfrom datetime import datetime,date,timedelta#将每日的漏斗数据传入进来def get_total_funnel_data(df):    result_df = df[df['当日_分社'] == '全国'].sort_values(by='当日_时间',ascending=True).reset_index(drop=True)    array = ['当日_已申请','当日_全部已配置课程数','当日_已领取','累计_已申请','累计_全部已配置课程数','累计_已领取']    result_df = result_df[array]    print (result_df)    print (result_df.info())    #环比增长速度＝（本期数－上期数）/上期数*100％    df1 = result_df.iloc[-1::].reset_index(drop=True)    df2 = result_df.iloc[-2:-1:].reset_index(drop=True)    df3 = df1.sub(df2,fill_value = 0).div(df2).rename(index={0:'日环比'})    #拼接日环比    result_df = pd.concat([result_df,df3])    #取出最后两列    result_df = result_df[-2::]    print (result_df)def get_community_funnel_data(df):PROJECT_ROOT = os.path.dirname(os.path.realpath(__file__))path = os.path.join(PROJECT_ROOT,'data/漏斗数据.xlsx')funnel_df = pd.read_excel(path)get_total_funnel_data(funnel_df)