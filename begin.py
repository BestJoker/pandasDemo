# coding:utf-8import pandas as pdimport numpy as npimport osfrom datetime import datetime,date,timedelta# import timetotoal_columns_dic = {    '页面uv' : '页面访问UV',    '填写报名申请总数' : '报名申请企业数',    '已经领取企业数量' : '联名企业数',    '课包领取-新增注册用户数' : '新注册用户数',    '成功领取人数' : '领取课程总用户数',    '领取看课人数' : '上课用户数'}def totalSheet():    #处理一下对应的columns    array = ['页面访问UV', '报名申请企业数','页面->报名企业转化率', '联名企业数','报名申请->联名企业转化率','领取课程总用户数','新注册用户数','上课用户数','上课转化率']    print (array)    result_df = pd.DataFrame(columns=array)    print (result_df)    #拼接总计数据    PROJECT_ROOT = os.path.dirname(os.path.realpath(__file__))    total_path_1 = os.path.join(PROJECT_ROOT, 'data/企业报名漏斗-累计数据.xlsx')    total_df_1 = pd.read_excel(total_path_1)    #将原有列映射重命名    total_df_1 = total_df_1.rename(columns=totoal_columns_dic)    #拼接到result数据中    result_df = pd.concat([result_df,total_df_1],join_axes=[result_df.columns])    #拼接当日数据    total_path_2 = os.path.join(PROJECT_ROOT,'data/企业报名漏斗-当日数据.xlsx')    total_df_2 = pd.read_excel(total_path_2)    print (total_df_2)    #将原有列映射重命名    total_df_2 = total_df_2.rename(columns=totoal_columns_dic)    #拼接到result数据中    result_df = pd.concat([result_df,total_df_2],join_axes=[result_df.columns])    #重命名index    last_date = (date.today() + timedelta(days=-1)).strftime("%m-%d")  # 昨天日期    index = ['累计', '当日' + '（' + last_date + '）']    result_df.index = index    #计算对应转化率    return result_dfdf = totalSheet()print (df)print (df.columns)