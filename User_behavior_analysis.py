# coding:utf-8import pandas as pdimport numpy as npimport osimport matplotlib.pyplot as pltimport seaborn as snsimport datetimepd.options.mode.chained_assignment = None # 默认是'warn'plt.rcParams['font.sans-serif']=['Microsoft YaHei'] #用来正常显示中文标签字体。Microsoft YaHei 或 SimHeiplt.rcParams['axes.unicode_minus']=False #用来正常显示负号#获取原始数据def get_orign_data():    #获取原始数据    PROJECT_ROOT = os.path.dirname(os.path.realpath(__file__))    path = os.path.join(PROJECT_ROOT, 'data/behavior.txt')    # 我使用txt文件是以tab键分隔的，故sep=‘\t’    orign_df = pd.read_csv(path, sep='\t')    print (orign_df.info())    return orign_df#处理元数据def handle_data(df):    #保留一份原始数据    temp_df = df.copy()    #1.观察数据    print (temp_df.head())    #2.检查是否有重复数据 - 没有    print (temp_df.duplicated().value_counts())    #3.处理时间，转化为访问网站的具体时间，月份，日期，每天几点    temp_df['time1'] = temp_df['time'].apply(lambda x:datetime.datetime.fromtimestamp(x))    temp_df['month'] = temp_df['time'].apply(lambda x: int(datetime.datetime.fromtimestamp(x).strftime('%Y%m')))    temp_df['date'] = temp_df['time'].apply(lambda x: datetime.datetime.fromtimestamp(x).strftime('%Y%m%d'))    temp_df['hour'] = temp_df['time1'].apply(lambda x:x.hour)    #4.销售金额计算    temp_df['money'] = temp_df['price']*temp_df['amount']    #5.缺失值处理：观看有没有缺失值    print (temp_df.isnull().sum())    #6.观察数据有没有异常值    print (temp_df.describe())    return temp_df#获取处理好的数据if __name__ == '__main__':    orign_df = get_orign_data()    data_df = handle_data(orign_df)